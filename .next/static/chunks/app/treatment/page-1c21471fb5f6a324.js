(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8397],{3988:function(e,t,r){Promise.resolve().then(r.bind(r,8850))},8850:function(e,t,r){"use strict";r.r(t),r.d(t,{CustomRadio:function(){return Z},default:function(){return z}});var l=r(7437),s=r(2853),a=r(9484),n=r(4922),i=r.n(n),o=r(2265),c=r(9475),d=r(7485),u=r(3968),m=r(3328),x=r(1213),h=r(8227),f=r(6808),p=r(8314),g=r(6691),b=r.n(g);let y=e=>Object.keys(e).map(t=>e[t]);var File=e=>{let{label:t,updateFilesCb:r,maxFileSizeInBytes:s=5e5,...a}=e,n=(0,o.useRef)(null),[i,c]=(0,o.useState)({}),[d,u]=(0,o.useState)(!1);(0,o.useEffect)(()=>{Object.keys(i).length>=3?u(!0):u(!1)},[i]);let m=e=>{let t={...i};for(let r of e)if(r.size<=s){if(!a.multiple)return{file:r};t[r.name]=r}return t},x=e=>{let t=y(e);r(t)},h=e=>{e in i&&delete i[e],c({...i}),x({...i})};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col items-center rounded-lg bg-white p-4 border border-dashed border-gray-300 min-w-[80vw] md:min-w-[380px] h-25",children:[(0,l.jsx)("div",{className:"font-bold text-center mb-4",children:"Upload Images"}),(0,l.jsxs)("button",{type:"button",disabled:d,className:"text-white rounded-lg bg-blue-600 px-4 py-2 hover:bg-blue-700 focus:outline-none disabled:opacity-50 cursor-pointer flex items-center",onClick:()=>{if(n&&n.current){var e;null===(e=n.current)||void 0===e||e.click()}},children:[(0,l.jsx)(f.Z,{className:"mr-2 h-6 w-6"}),(0,l.jsxs)("span",{children:["Upload ",a.multiple?"files":"a file"]})]}),(0,l.jsx)("input",{type:"file",ref:n,onChange:e=>{let{files:t}=e.target;if(t.length){let e=m(t);c(e),x(e)}},title:"",value:"",...a,className:"hidden"}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"flex flex-wrap justify-center mt-2",children:Object.keys(i).map((e,t)=>{let r=i[e],s="image"===r.type.split("/")[0];return(0,l.jsxs)("div",{className:"w-1/4 rounded-lg mr-2 mb-2 flex relative",children:[s&&(0,l.jsx)(b(),{className:"rounded-lg w-full h-full object-cover",src:URL.createObjectURL(r),alt:"file preview ".concat(t),width:250,height:250}),(0,l.jsx)("div",{className:"absolute inset-0 rounded-lg bg-black opacity-50 flex items-center justify-center ".concat(s?"":"hidden"),children:(0,l.jsx)(p.Z,{className:"h-6 w-6 text-white cursor-pointer hover:scale-110",onClick:()=>h(e)})})]},e)})})})]})})},j=r(2685),v=r(8368),w=r(4710),N=()=>(0,l.jsx)("div",{className:"loader",children:(0,l.jsxs)("div",{className:"three-body",children:[(0,l.jsx)("div",{className:"three-body__dot"}),(0,l.jsx)("div",{className:"three-body__dot"}),(0,l.jsx)("div",{className:"three-body__dot"})]})}),k=r(7415),_=r(3046),C=r(9971);let q="nextcare.life",S=new j.g({region:"us-east-2",credentials:{accessKeyId:"AKIAZI2LCNUH7TCAU7XU",secretAccessKey:"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"}});var A=()=>{let e=(0,_.I0)(),[t,r]=(0,o.useState)(!1),[s,a]=(0,o.useState)({uploadFile:[]}),n=async e=>{let t=s.uploadFile;a({...s,uploadFile:e});let r=e.filter(e=>!t.some(t=>t.name===e.name)),l=t.filter(t=>!e.some(e=>e.name===t.name));r.length>0&&await i(r),l.length>0&&await c(l)},i=async t=>{let l=t[0];if(r(!0),l){let t={Bucket:q,Key:l.name,Body:l};try{await S.send(new v.U(t)),r(!1),k.Am.success("Image Uploaded Successfully"),e((0,C.eg)(l.name))}catch(e){console.error(e),r(!1),alert("Error uploading file: "+e.message)}}},c=async t=>{let l=t[0];if(r(!0),l){let t={Bucket:q,Key:l.name};try{await S.send(new w.C(t)),r(!1),k.Am.success("Image Deleted Successfully"),e((0,C.xR)(l.name))}catch(e){console.error(e),r(!1),alert("Error uploading file: "+e.message)}}};return(0,l.jsxs)("div",{children:[t&&(0,l.jsx)(N,{}),(0,l.jsx)(File,{accept:".jpg,.png,.jpeg",label:"Profile Image(s)",multiple:!0,updateFilesCb:n})]})},P=r(6898);let I=()=>new Promise(e=>{let t=document.createElement("script");t.src="https://checkout.razorpay.com/v1/checkout.js",t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},document.body.appendChild(t)});var O=r(4033),F=r(605),E=r(3181),R=r(2670);let U=e=>{let{children:t,...r}=e;return(0,l.jsx)(c.J,{...r,classNames:{base:(0,d.cn)("inline-flex m-0 bg-content1 hover:bg-content2 items-center justify-between","flex-row-reverse max-w-full cursor-pointer rounded-lg gap-4 p-4 border-2 border-transparent","data-[selected=true]:border-primary")},children:t})},K=e=>{let{children:t,...r}=e;return(0,l.jsx)(u.K,{...r,classNames:{base:(0,d.cn)("inline-flex max-w-md w-full bg-content1 m-0","hover:bg-content2 items-center justify-start","cursor-pointer rounded-lg gap-2 p-4 border-2 border-transparent","data-[selected=true]:border-primary"),label:"w-full"},children:t})};function T(e){let{question:t}=e,r=(0,_.I0)(),[s,a]=(0,o.useState)({});return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("textarea",{onBlur:()=>{let e=Object.keys(s),t=e[0],l=s[t];r((0,C.tn)({id:t,value:l}))},onChange:e=>{let{name:t,value:l}=e.target;a({...s,[t]:l}),l.length>3?r((0,C.qw)(!1)):r((0,C.qw)(!0))},name:t.question_id,value:s[t.question_id],placeholder:"Type your problem",className:"bg-gray-50 border border-gray-300 text-gray-900 text-md rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-4 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})})}var B=e=>{let{questionary:t,backToKeyCriteria:r}=e,{currentStep:s,answers:n,disableNext:i,photoUploadEnable:c,uploadImages:d}=(0,_.v9)(e=>e.questionary),[u,f]=(0,o.useState)(!1),p=(0,O.useRouter)(),g=(0,_.I0)(),{user:b,userSession:y}=(0,P.a)(),[j,v]=(0,o.useState)([]);(0,o.useEffect)(()=>{window&&window.scrollTo({top:0,behavior:"smooth"})},[]);let w=(e,t)=>{let{value:r}=e.target,l=null==t?void 0:t.question_id;g((0,C.tn)({id:l,value:r})),g((0,C.qw)(!1))},q=(e,t)=>{v(e),e.length>0?g((0,C.qw)(!1)):g((0,C.qw)(!0));let r=null==e?void 0:e.join(",");g((0,C.tn)({id:t,value:r}))},S=async()=>{f(!0);let e=await I();if(!e){alert("Something went wrong"),f(!1);return}let t=await fetch("/api/payment",{method:"POST",body:JSON.stringify({amount:250,currency:"INR",receipt:"order_rcpt_"+Date.now(),payment_capture:1})}),r=await t.json();if(!r){f(!1),alert("Server error. Are you online?");return}var l={key:r.rozerpayKey,name:"Next.care",currency:r.currency,amount:r.amount,order_id:r.id,description:"Thank you for shopping with us",handler:async function(e){if(e){await a.BN({session_id:y,user_id:b,question_answers:[n]});let e=(null==d?void 0:d.map(e=>"https://s3.us-east-2.amazonaws.com/nextcare.life/"+e))||[],t="";e&&(t=e.join(","));let r={patient_id:b,image_path:t},l=await a.X5(r);l&&200===l.status?((0,F.dZ)("keyCriteria"),k.Am.success(l.message||"Case created successfully"),p.replace("/user/sessions")):k.Am.error("The user already has a case created"),f(!1)}},prefill:{name:"Akash Pradhan",email:"akashpradhan@gmail.com",contact:"9999999999"}};let s=new window.Razorpay(l);s.open(),f(!1)};return(0,o.useEffect)(()=>{1===s&&g((0,R.b_)(!0))},[s]),(0,l.jsxs)("div",{children:[u&&(0,l.jsx)("div",{className:"w-full flex flex-col items-center justify-center",children:(0,l.jsx)(N,{})}),(0,l.jsxs)("div",{className:"w-full flex flex-col items-center justify-center",children:[!c&&t&&(null==t?void 0:t.map((e,t)=>(0,l.jsx)("div",{className:"w-full",children:t===s&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col w-full",children:[(0,l.jsxs)("p",{className:" pb-2 pl-1",children:[(0,l.jsx)("span",{className:"text-xl font-semibold text-start",children:e.question_type})," "]}),(0,l.jsx)(l.Fragment,{children:(null==e?void 0:e.allowed_values.length)>1?(null==e?void 0:e.multiple_val_allowed)?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(m.X,{classNames:{base:"w-full"},value:j,onChange:t=>q(t,null==e?void 0:e.question_id),children:e.allowed_values.map(t=>(0,l.jsx)(K,{value:t,name:e.question_id,children:t},t))})}):(0,l.jsx)(x.X,{onChange:t=>w(t,e),value:n[e.question_id],name:e.question_id,className:"w-full text-black",children:e.allowed_values.map(e=>(0,l.jsx)(U,{name:e,value:e,children:e},e))}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(T,{question:e})})})]},e.question_id)})},t))),c&&(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(A,{})}),(0,l.jsxs)("div",{className:"flex justify-center gap-3 mt-3",children:[s>0&&(0,l.jsx)(h.A,{onClick:()=>{c&&g((0,C.g$)(!1)),g((0,C.qw)(!1)),g((0,C.RS)())},className:"grow justify-center px-5 py-2.5 text-white border-2 border-black border-solid rounded-full bg-black",children:"Previous"}),0==s&&(0,l.jsx)(h.A,{onClick:()=>{r(!1)},className:"grow justify-center px-5 py-2.5 text-white border-2 border-black border-solid rounded-full bg-black",children:"Previous"}),s<t.length-1&&(0,l.jsx)(h.A,{isDisabled:i,onClick:()=>{g((0,C.qw)(!0)),g((0,C.uY)())},className:"grow justify-center px-5 py-2.5 text-white bg-violet-600 rounded-[96.709px]",children:"Next"}),s===t.length-1&&(0,l.jsx)(h.A,{isDisabled:i,onClick:()=>{g((0,C.uY)()),g((0,C.g$)(!0))},className:"grow justify-center px-5 py-2.5 text-white bg-violet-600 rounded-[96.709px]",children:"Next"}),c&&(0,l.jsx)(h.A,{onClick:()=>{if(!b){k.Am.error("Please login first"),p.push("/auth/login");return}S()},className:"grow justify-center px-5 py-2.5 text-white bg-violet-600 rounded-[96.709px]",children:"Payment"})]})]}),(0,l.jsx)(E.Z,{isCloseIcon:!0})]})};let D=e=>{let{children:t,value:r,...s}=e;return(0,l.jsx)(c.J,{value:r,...s,classNames:{base:(0,d.cn)("inline-flex m-0 bg-content1 hover:bg-content2 items-center justify-between","flex-row-reverse max-w-full cursor-pointer rounded-lg gap-4 p-4 border-2 border-transparent","data-[selected=true]:border-primary")},children:t})};var L=e=>{let{question:t,options:r,onSelect:s,defaultSelected:a}=e,n=(null==a?void 0:a[t])||"";return(0,l.jsx)("div",{className:"w-full",children:t&&t.length>0&&(0,l.jsxs)("div",{className:"w-full flex flex-col items-center justify-center",children:[(0,l.jsx)("p",{className:"w-full text-start pb-2 pl-1",children:(0,l.jsxs)("span",{className:"text-xl font-semibold text-start",children:[t,(0,l.jsx)("span",{className:"text-red-500",children:" *"})]})}),(0,l.jsx)(x.X,{name:t,className:"w-full text-black mb-3",value:n,onChange:e=>s(e),children:r&&r.length>0&&r.split(",").map((e,t)=>(0,l.jsx)(D,{value:e,children:e},e+"_"+t))})]})})};let Z=e=>{let{children:t,value:r,...s}=e;return(0,l.jsx)(c.J,{value:r,...s,classNames:{base:(0,d.cn)("inline-flex m-0 bg-content1 hover:bg-content2 items-center justify-between","flex-row-reverse max-w-full cursor-pointer rounded-lg gap-4 p-4 border-2 border-transparent","data-[selected=true]:border-primary")},children:t})};var z=()=>{let{isLoggedIn:e}=(0,P.a)(),t=(0,_.I0)(),{data:r,isLoading:n,error:c}=(0,s.ZP)("/view_key_criteria",()=>a.Qn(),{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateIfStale:!1});if(c)throw c;let[d,u]=(0,o.useState)({}),[m,x]=(0,o.useState)(!1),[f,p]=(0,o.useState)([]),[g,b]=(0,o.useState)(!1),y=null==r?void 0:r.key_criteria;(0,o.useEffect)(()=>{if(r&&(null==r?void 0:r.key_criteria)){let e=(0,F.$o)("keyCriteria");e&&u(()=>e)}},[r]);let j=(e,t)=>{u(r=>{var l;return{...r,[t]:(null===(l=null==e?void 0:e.target)||void 0===l?void 0:l.value)||""}})},v=async(e,r)=>{try{if(console.log("Called"),e.preventDefault(),!d.hasOwnProperty(r)){k.Am.error("Please select any option");return}b(!0);let s="";(0,F.qQ)("keyCriteria",d),d&&Object.values(d).forEach(e=>{e&&(s+=e)});let n=i()(s);if(n){var l;let e=[],r=await a.hL(n);if(r&&(null===(l=r.records)||void 0===l?void 0:l.length)>0?r.records.map(t=>{let r=null==t?void 0:t.question_id,l=r&&r.toString();e.push(l)}):k.Am.error("No records found"),e&&e.length>0){let r=await a.CC({question_ids:e});r&&r.questions?(p(null==r?void 0:r.questions),x(!0),t((0,C.PN)())):(k.Am.error("No question found"),b(!1))}}b(!1)}catch(e){console.log(e)}},[w,q]=(0,o.useState)(0),S=(e,t)=>{if(e.preventDefault(),!d.hasOwnProperty(t)){k.Am.error("Please select any option");return}q(w+1)};return(0,l.jsx)(l.Fragment,{children:n?(0,l.jsx)(N,{}):(0,l.jsxs)("div",{className:"w-full",children:[y&&!m&&y.map((e,t)=>(0,l.jsx)("div",{className:"w-full",children:w===t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L,{question:e[1],options:e[2],defaultSelected:d,onSelect:t=>j(t,e[1])},e[0]+"_"+t),(0,l.jsxs)("div",{className:"w-full flex justify-center gap-4",children:[(0,l.jsx)(h.A,{onClick:e=>q(w-1),color:"primary",className:"grow justify-center px-5 py-2.5 text-white bg-black   rounded-[96.709px] disabled:bg-gray-600",disabled:0===w,children:"Prev"}),y.length-1===w?(0,l.jsx)(h.A,{onClick:t=>v(t,e[1]),color:"primary",isLoading:g,className:"grow justify-center px-5 py-2.5 text-white bg-violet-600   rounded-[96.709px]",children:"Submit"}):(0,l.jsx)(h.A,{onClick:t=>S(t,e[1]),color:"primary",className:"grow justify-center px-5 py-2.5 text-white bg-violet-600   rounded-[96.709px]",children:"Next"})]})]})},e[0]+"_"+t)),m&&(0,l.jsx)(B,{questionary:f,backToKeyCriteria:e=>{x(e)}})]})})}}},function(e){e.O(0,[411,1104,8227,2173,8326,2853,7138,413,7595,7090,3759,5451,2742,2971,2472,1744],function(){return e(e.s=3988)}),_N_E=e.O()}]);